<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Clue</title>
    <script type="text/javascript">
        // Array of video URLs
        var videoLinks = [
            "video_clues/video1.mp4",
            "video_clues/video2.mp4",
            "video_clues/video3.mp4"
        ];

        // Function to get a random video that hasn't been used recently
        function getRandomUniqueVideo() {
            // Check if there's already a session video assigned
            var sessionVideoIndex = sessionStorage.getItem('videoIndex');
            if (sessionVideoIndex !== null) {
                return sessionVideoIndex;
            }

            // Check if other devices have used any video in the current browser window
            var usedVideos = JSON.parse(localStorage.getItem('usedVideos')) || [];

            // Filter out the already used videos from the available ones
            var availableVideos = videoLinks.filter(function(video, index) {
                return !usedVideos.includes(index);
            });

            // If all videos are used, reset the available list
            if (availableVideos.length === 0) {
                usedVideos = [];  // Reset the used videos list
                availableVideos = videoLinks;  // All videos are available again
            }

            // Randomly select an available video index
            var randomIndex = Math.floor(Math.random() * availableVideos.length);
            var selectedIndex = videoLinks.indexOf(availableVideos[randomIndex]);

            // Add the selected video index to used videos in localStorage
            usedVideos.push(selectedIndex);
            localStorage.setItem('usedVideos', JSON.stringify(usedVideos));

            // Save the selected video index in sessionStorage for persistence on reload
            sessionStorage.setItem('videoIndex', selectedIndex);

            return selectedIndex;
        }

        // On page load, set the video source to the appropriate video
        window.onload = function() {
            var videoIndex = getRandomUniqueVideo();
            var videoUrl = videoLinks[videoIndex];
            document.getElementById("video-player").src = videoUrl;
        }
    </script>

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Treasure Hunt Final Clue</h1>

    <!-- Video player to embed the video -->
    <video id="video-player" width="640" height="360" controls autoplay muted loop>
        <source src="" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</body>
</html>




