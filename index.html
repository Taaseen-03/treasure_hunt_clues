<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Clue</title>
    <script type="text/javascript">
        // Array of video URLs
        var videoLinks = [
            "video_clues/video1.mp4",
            "video_clues/video2.mp4",
            "video_clues/video3.mp4"
        ];

        var totalVideos = videoLinks.length;  // Total number of videos
        var cooldownTime = 60 * 60 * 1000; // 1 hour cooldown to reset the sequence

        // Get a global timestamp for assigning video clues reliably
        function getGlobalTimeOffset() {
            var baseTimestamp = Date.now();  // Get the current time in milliseconds
            return Math.floor(baseTimestamp / cooldownTime);  // Normalize the time to 1-hour periods
        }

        // Function to assign the next video index sequentially based on the global timestamp
        function getNextVideoIndex() {
            var globalOffset = getGlobalTimeOffset();  // Get the current time period
            var lastAssignedIndex = localStorage.getItem('lastAssignedIndex') || -1;

            // Calculate the next video in sequence based on the global timestamp
            var nextIndex = (parseInt(lastAssignedIndex) + 1) % totalVideos;

            // Check if the global offset has changed (i.e., enough time has passed to reset the sequence)
            var lastGlobalOffset = localStorage.getItem('lastGlobalOffset') || -1;

            if (lastGlobalOffset != globalOffset) {
                // If the time has changed enough (1 hour), reset to first video
                localStorage.setItem('lastAssignedIndex', 0);
                localStorage.setItem('lastGlobalOffset', globalOffset);
                nextIndex = 0;
            } else {
                // Update to the next video index
                localStorage.setItem('lastAssignedIndex', nextIndex);
            }

            return nextIndex;
        }

        // On page load, set the video source to the appropriate video
        window.onload = function() {
            // Check if a video has already been assigned for this session
            var sessionVideoIndex = sessionStorage.getItem('videoIndex');

            // If no video was assigned in the session, get the next one
            if (sessionVideoIndex === null) {
                var videoIndex = getNextVideoIndex(); // Get the next video in sequence
                sessionStorage.setItem('videoIndex', videoIndex); // Store it for session persistence
            } else {
                videoIndex = sessionVideoIndex;
            }

            // Get the corresponding video URL based on the session-stored video index
            var videoUrl = videoLinks[videoIndex];
            document.getElementById("video-player").src = videoUrl;  // Set the video source
        }
    </script>

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Treasure Hunt Final Clue</h1>

    <!-- Video player to embed the video -->
    <video id="video-player" width="640" height="360" controls autoplay muted loop>
        <source src="" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</body>
</html>











